from payments.models import PostfinanceTransaction


fulfilled_transactions = [
    #    157872295,
    # 157870649,
    # 157868948,
    # 157866719,
    # 157863005,
    # 157862233,
    # 157862163,
    # 157855640,
    # 157855445,
    # 157854247,
    # 157852906,
    # 157852582,
    # 157852508,
    # 157851487,
    # 157851107,
    # 157850163,
    # 157849661,
    # 157849601,
    # 157849581,
    # 157848469,
    # 157848186,
    # 157848079,
    # 157847530,
    # 157845014,
    # 157844869,
    # 157844624,
    # 157844503,
    # 157843342,
    # 157843259,
    # 157842863,
    # 157842694,
    # 157842542,
    # 157842324,
    # 157842293,
    # 157842292,
    # 157842256,
    # 157841771,
    # 157841236,
    # 157841120,
    # 157841087,
    157840942,
    157840431,
    157840240,
    157839984,
    157839839,
    157839739,
    157839470,
    157839391,
    157839109,
    157838256,
    157838203,
    157837491,
    157837370,
    157837222,
    157837108,
    157837059,
    157837003,
    157836995,
    157836612,
    157836436,
    157836274,
    157836197,
    157836146,
    157835821,
    157835772,
    157835749,
    157835001,
    157834940,
    157834918,
    157834804,
    157834780,
    157834774,
    157834759,
    157834668,
    157834655,
    157834647,
    157834513,
    157834359,
    157834157,
    157834156,
    157834061,
    157833862,
    157833847,
    157833834,
    157833829,
    157833738,
    157833680,
    157833473,
    157833454,
    157833283,
    157833282,
    157833250,
    157833201,
    157833193,
    157833138,
    157833112,
    157832988,
    157832984,
    157832968,
    157832945,
    157832883,
    157832853,
    157832849,
    157832815,
    157832716,
    157832617,
]


for transaction_id in fulfilled_transactions:
    print(transaction_id)
    try:
        transaction = PostfinanceTransaction.objects.get(transaction_id=transaction_id)
    except PostfinanceTransaction.DoesNotExist:
        continue
    was_pending = transaction.is_pending
    transaction.update_status()
    if transaction.is_success and was_pending:
        print("success, updating invoice")
        transaction.update_invoice()
        print("send confirmation")
        transaction.invoice.send_confirmation()
