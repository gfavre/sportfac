
from import_export.formats.base_formats import XLSX

fmt = XLSX()
f = open('/Users/grfavre/Desktop/car 3 et train 5.xlsx', fmt.get_read_mode())
dataset = fmt.create_dataset(f.read())

t = []
for (registration_id, car_id, bib_number, last, first) in dataset:
    t.append((registration_id, car_id, bib_number, last, first))

t = [(114L, 3L, 301L, u'Alili Bustabad', u'Adrian'),
 (339L, 3L, 302L, u'Olivier', u'Alice'),
 (321L, 3L, 303L, u'Rossier', u'Anastasia'),
 (383L, 3L, 304L, u'Sansar', u'Bat Orgil'),
 (107L, 3L, 305L, u'Corday', u'Benjamin'),
 (65L, 3L, 306L, u'Jaloul', u'Boris'),
 (325L, 3L, 307L, u'Gonnet', u'Carl'),
 (120L, 3L, 308L, u'Zaharcenco', u'Constantin'),
 (146L, 3L, 309L, u'Cuany', u'Dany'),
 (235L, 3L, 310L, u'Bosnjak', u'Daris'),
 (294L, 3L, 311L, u'Alves Vala', u'Diogo'),
 (63L, 3L, 312L, u'Jaloul', u'Elena'),
 (241L, 3L, 313L, u'Schneider', u'Haris'),
 (246L, 3L, 314L, u'Cappelle', u'Jarod'),
 (250L, 3L, 315L, u'Cappelle', u'Jason'),
 (316L, 3L, 316L, u'Baillod', u'Kiana'),
 (291L, 3L, 317L, u'Baladan', u'Leandro'),
 (208L, 3L, 318L, u'Felice', u'Lony'),
 (136L, 3L, 319L, u'Mazreku', u'Lorik'),
 (156L, 3L, 320L, u'Tschanz', u'Loris'),
 (113L, 3L, 321L, u'Simon Serralta', u'Lua'),
 (249L, 3L, 322L, u'Blagojevic', u'Marko'),
 (280L, 3L, 323L, u'Riganti', u'Martina'),
 (295L, 3L, 324L, u'Domingues Teixeira', u'Melissa'),
 (281L, 3L, 325L, u'Riganti', u'Mirko'),
 (219L, 3L, 326L, u'Gligorijevic', u'Nikola'),
 (338L, 3L, 327L, u'Teijeiro', u'Nora'),
 (287L, 3L, 328L, u'Markotic', u'Petra'),
 (119L, 3L, 329L, u'Zaharcenco', u'Sofia'),
 (72L, 3L, 330L, u"Duran-Bourc'h", u'Th\xe9ana'),
 (329L, 3L, 331L, u'Ahmeti', u'Ylli'),
 (330L, 3L, 332L, u"D'Antino", u'Achille'),
 (137L, 3L, 333L, u'Sannier', u'Aline'),
 (64L, 3L, 334L, u'Babakki Barry', u'Amina'),
 (282L, 3L, 335L, u'Chappuis', u'Ana\xeblle'),
 (48L, 3L, 336L, u'Levy', u'Axel Ethan'),
 (275L, 3L, 337L, u'da Silva Santos', u'Carlota'),
 (230L, 3L, 338L, u'Castillo Polo', u'Dario'),
 (164L, 3L, 339L, u'Mesple', u'Elisa'),
 (267L, 3L, 340L, u'Jo\u0161tov\xe1', u'Eli\u0161ka'),
 (163L, 3L, 341L, u'Ounissi Ferreira', u'In\xe8s'),
 (185L, 3L, 342L, u'Koster', u'Ivar'),
 (229L, 3L, 343L, u'Clerc', u'Jessica'),
 (49L, 3L, 344L, u'Levy', u'Johan David'),
 (159L, 3L, 345L, u'Lambert', u'Jules'),
 (269L, 3L, 346L, u'Lottini', u'Julie'),
 (68L, 3L, 347L, u'Zanotti', u'Kevin'),
 (268L, 3L, 348L, u'Mathey', u'Kim-Lou'),
 (258L, 3L, 349L, u'Acimovic', u'Lazar'),
 (337L, 3L, 350L, u'Ara\xfajo Da Silva', u'Leonardo'),
 (160L, 3L, 351L, u'Lambert', u'Lucie'),
 (307L, 3L, 352L, u'Schweitzer', u'Mat\xe9o'),
 (102L, 3L, 353L, u'Delley', u'Mathias'),
 (293L, 3L, 354L, u'Scianna', u'Maxime'),
 (357L, 3L, 355L, u'Carre\xf1o Hormaz\xe1bal', u'Mayna'),
 (217L, 3L, 356L, u'Buccarello', u'Morena'),
 (103L, 3L, 357L, u'Delley', u'Nicolas'),
 (180L, 3L, 358L, u'Wingfield', u'Oriana'),
 (131L, 3L, 359L, u'Levy', u'Sam Ely'),
 (273L, 3L, 360L, u'Crettaz', u'Santiago'),
 (270L, 3L, 361L, u'Lottini', u'Shanice'),
 (187L, 3L, 362L, u'Verreschi', u'Vanessa'),
 (212L, 3L, 363L, u"D'Antino", u'Zelda'),
 (233L, 5L, 501L, u'Ahmed', u'Kamar Etta'),
 (232L, 5L, 501L, u'Ahmed', u'Kenan'),
 (117L, 5L, 501L, u'Akeza', u'Teta'),
 (178L, 5L, 501L, u'Akpo', u'Marcus'),
 (385L, 5L, 501L, u'Alame', u'Karim'),
 (345L, 5L, 501L, u'Amoros Rezzoug', u'Lydia'),
 (344L, 5L, 501L, u'amoros Rezzoug', u'Yasmine'),
 (77L, 5L, 501L, u'Atrash', u'Julien'),
 (33L, 5L, 501L, u'Brotto', u'Alessio'),
 (35L, 5L, 501L, u'Brotto', u'Irene'),
 (81L, 5L, 501L, u'Caputo', u'No\xe9mie'),
 (272L, 5L, 501L, u'Carranza Durand', u'Leticia'),
 (285L, 5L, 501L, u'Chamas', u'Myriam'),
 (358L, 5L, 501L, u'Ciampi', u'Sarah Laura'),
 (196L, 5L, 501L, u'Dawit Weldeslasie', u'Arsema'),
 (257L, 5L, 501L, u'D\xe9corvet', u'Karim'),
 (133L, 5L, 501L, u'Detrey', u'Clarice'),
 (134L, 5L, 501L, u'Detrey', u'Jada'),
 (197L, 5L, 501L, u'Dichovska', u'Milena'),
 (303L, 5L, 501L, u'Do Nascimento Santana', u'Nicole'),
 (349L, 5L, 501L, u'Domingues', u'Hugo'),
 (261L, 5L, 501L, u'Dominique', u'Ana\xefs'),
 (278L, 5L, 501L, u'Faizi', u'Hashmatullah'),
 (386L, 5L, 501L, u'Filmon', u'Ariam'),
 (200L, 5L, 501L, u'Fisseha', u'Seim Daniel'),
 (254L, 5L, 501L, u'Fisseha', u'Yared Daniel'),
 (248L, 5L, 501L, u'Freitas Praia', u'Grazielle'),
 (331L, 5L, 501L, u'Gashi', u'Edon'),
 (259L, 5L, 501L, u'Gozzing', u'Luane'),
 (44L, 5L, 501L, u'Guarnieri Baglini', u'Vera'),
 (73L, 5L, 501L, u'Guex', u'Louise'),
 (201L, 5L, 501L, u'Habtemariam', u'Ruta'),
 (198L, 5L, 501L, u'Habtom', u'Samrawit'),
 (132L, 5L, 501L, u'Inthornprom', u'Patcharapon'),
 (88L, 5L, 501L, u'Kuleshov', u'Philipp'),
 (95L, 5L, 501L, u'Lefauconnier', u'Aden Ray'),
 (194L, 5L, 501L, u'Lheriau', u'Eva'),
 (89L, 5L, 501L, u'Mandr\xe0', u'Evan'),
 (305L, 5L, 501L, u'Muharremi', u'Armend'),
 (195L, 5L, 501L, u'Mustafazada', u'Said Masi'),
 (252L, 5L, 501L, u'Nieuwenhuizen', u'Capucine'),
 (277L, 5L, 501L, u'Omarkhel', u'Ahmad Zamir'),
 (335L, 5L, 501L, u'Perrino', u'Lenny'),
 (354L, 5L, 501L, u'Ric', u'Elisabeth'),
 (306L, 5L, 501L, u'Salem', u'Arij'),
 (109L, 5L, 501L, u'Sarasin', u'Julia'),
 (374L, 5L, 501L, u'Savu', u'Darian'),
 (373L, 5L, 501L, u'Savu', u'Rom\xe9o'),
 (376L, 5L, 501L, u'Schetty Crucello', u'Nat\xe1lia'),
 (216L, 5L, 501L, u'Schiffke', u'Emilie'),
 (276L, 5L, 501L, u'Shakeri', u'Qayoum'),
 (199L, 5L, 501L, u'Shalhoub', u'Maya'),
 (127L, 5L, 501L, u'Stauder', u'Albane Marine'),
 (126L, 5L, 501L, u'Veseli', u'Leonit'),
 (309L, 5L, 501L, u'Yonas Russom', u'Sinodos'),
 (182L, 5L, 501L, u'Zahnd', u'Joanna Lauren'),
 (181L, 5L, 501L, u'Zahnd', u'Julia Alexia'),
 (83L, 5L, 501L, u'Zharikov', u'Vsevolod')]



fmt = XLSX()
f = open('/Users/grfavre/Desktop/train 5.xlsx', fmt.get_read_mode())
dataset = fmt.create_dataset(f.read())

t = []
for (registration_id, car_id, bib_number, last, first) in dataset:
    t.append((registration_id, car_id, bib_number, last, first))

t=[(95L, 5L, 501L, u'Lefauconnier', u'Aden Ray'),
 (277L, 5L, 502L, u'Omarkhel', u'Ahmad Zamir'),
 (127L, 5L, 503L, u'Stauder', u'Albane Marine'),
 (33L, 5L, 504L, u'Brotto', u'Alessio'),
 (261L, 5L, 505L, u'Dominique', u'Ana\xefs'),
 (386L, 5L, 506L, u'Filmon', u'Ariam'),
 (306L, 5L, 507L, u'Salem', u'Arij'),
 (305L, 5L, 508L, u'Muharremi', u'Armend'),
 (196L, 5L, 509L, u'Dawit Weldeslasie', u'Arsema'),
 (252L, 5L, 510L, u'Nieuwenhuizen', u'Capucine'),
 (133L, 5L, 511L, u'Detrey', u'Clarice'),
 (374L, 5L, 512L, u'Savu', u'Darian'),
 (331L, 5L, 513L, u'Gashi', u'Edon'),
 (354L, 5L, 514L, u'Ric', u'Elisabeth'),
 (216L, 5L, 515L, u'Schiffke', u'Emilie'),
 (194L, 5L, 516L, u'Lheriau', u'Eva'),
 (89L, 5L, 517L, u'Mandr\xe0', u'Evan'),
 (248L, 5L, 518L, u'Freitas Praia', u'Grazielle'),
 (278L, 5L, 519L, u'Faizi', u'Hashmatullah'),
 (349L, 5L, 520L, u'Domingues', u'Hugo'),
 (35L, 5L, 521L, u'Brotto', u'Irene'),
 (134L, 5L, 522L, u'Detrey', u'Jada'),
 (182L, 5L, 523L, u'Zahnd', u'Joanna Lauren'),
 (109L, 5L, 524L, u'Sarasin', u'Julia'),
 (181L, 5L, 525L, u'Zahnd', u'Julia Alexia'),
 (77L, 5L, 526L, u'Atrash', u'Julien'),
 (233L, 5L, 527L, u'Ahmed', u'Kamar Etta'),
 (385L, 5L, 528L, u'Alame', u'Karim'),
 (257L, 5L, 529L, u'D\xe9corvet', u'Karim'),
 (232L, 5L, 530L, u'Ahmed', u'Kenan'),
 (335L, 5L, 531L, u'Perrino', u'Lenny'),
 (126L, 5L, 532L, u'Veseli', u'Leonit'),
 (272L, 5L, 533L, u'Carranza Durand', u'Leticia'),
 (73L, 5L, 534L, u'Guex', u'Louise'),
 (259L, 5L, 535L, u'Gozzing', u'Luane'),
 (345L, 5L, 536L, u'Amoros Rezzoug', u'Lydia'),
 (178L, 5L, 537L, u'Akpo', u'Marcus'),
 (199L, 5L, 538L, u'Shalhoub', u'Maya'),
 (197L, 5L, 539L, u'Dichovska', u'Milena'),
 (285L, 5L, 540L, u'Chamas', u'Myriam'),
 (376L, 5L, 541L, u'Schetty Crucello', u'Nat\xe1lia'),
 (303L, 5L, 542L, u'Do Nascimento Santana', u'Nicole'),
 (81L, 5L, 543L, u'Caputo', u'No\xe9mie'),
 (132L, 5L, 544L, u'Inthornprom', u'Patcharapon'),
 (88L, 5L, 545L, u'Kuleshov', u'Philipp'),
 (276L, 5L, 546L, u'Shakeri', u'Qayoum'),
 (373L, 5L, 547L, u'Savu', u'Rom\xe9o'),
 (201L, 5L, 548L, u'Habtemariam', u'Ruta'),
 (195L, 5L, 549L, u'Mustafazada', u'Said Masi'),
 (198L, 5L, 550L, u'Habtom', u'Samrawit'),
 (358L, 5L, 551L, u'Ciampi', u'Sarah Laura'),
 (200L, 5L, 552L, u'Fisseha', u'Seim Daniel'),
 (309L, 5L, 553L, u'Yonas Russom', u'Sinodos'),
 (117L, 5L, 554L, u'Akeza', u'Teta'),
 (44L, 5L, 555L, u'Guarnieri Baglini', u'Vera'),
 (83L, 5L, 556L, u'Zharikov', u'Vsevolod'),
 (254L, 5L, 557L, u'Fisseha', u'Yared Daniel'),
 (344L, 5L, 558L, u'amoros Rezzoug', u'Yasmine')]

from registrations.models import Registration, Transport

for (registration_id, car_id, bib_number, last, first) in t:
    try:
        reg = Registration.objects.get(pk=registration_id)
    except Registration.DoesNotExist:
        print("reg %s does not exist" % registration_id)
    if not last == reg.child.last_name:
        print("Name is wrong (%s)! Skipping reg %s" % (last, registration_id))
        continue
    if not str(bib_number) == reg.child.bib_number:
        print('bib number is wrong, fixing it')
        reg.child.bib_number = bib_number
        reg.child.save()
    reg.transport = Transport.objects.get(name=str(car_id))
    reg.save()
    print('ok')