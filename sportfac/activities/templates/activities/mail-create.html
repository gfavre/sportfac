{% extends "base.html" %}
{% load crispy_forms_tags i18n mail_tags %}

{% block title %}{% translate "New email" %} - {{ block.super }}{% endblock %}

{% block page_title %}<i class="icon icon-mail"></i>&nbsp;&nbsp;{% translate "New email" %}{% endblock %}

{% block content %}
  <form action="" method="post" enctype="multipart/form-data">
    {% csrf_token %}

    {% if recipients %}
      <div class="form-group">
        <label class="control-label col-sm-2" for="id_recipients">{% translate "To" %}</label>
        <div class=" field-recipient col-sm-10">
          <p class="form-control-static">
            {% for recipient in recipients %}
              <span class="label label-primary">{{ recipient }}</span>
            {% endfor %}
          </p>
        </div>
      </div>
    {% endif %}

    {{ form.non_field_errors }}

    {{ form.subject|as_crispy_field }}
    {{ form.message|as_crispy_field }}
    {{ form.attachments|as_crispy_field }}

    {% if archive and archive.attachments.count %}
      <div class="form-group">
        <div class="col-sm-10 col-sm-offset-2">
          <ul>
            {% for attachment in archive.attachments.all %}
              <li>{{ attachment|filename }}</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    {% endif %}
    {{ form.send_copy|as_crispy_field }}
    {{ form.copy_all_instructors|as_crispy_field }}

    <div class="form-group">
      <div class="col-sm-offset-2">
        <button type="submit" class="btn btn-success btn-large">
          <i class="icon-check"></i>&nbsp;{% translate 'Save and preview' %}
        </button>
        {% if prev %}&nbsp;
          <a href="{{ prev }}" class="btn btn-default">{% translate 'Cancel' %}</a>
        {% endif %}
      </div>
    </div>
  </form>
{% endblock content %}
