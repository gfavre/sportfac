{% extends "backend/base.html" %}
{% load i18n %}
{% load money phone duration %}

{% block title %}{{ object.full_name }} - {{ block.super }}{% endblock %}
{% block page_title %}{{ object.full_name }}{% endblock %}

{% block content %}
<section class="portlet">
  <h4 class="portlet-title"><u>{% trans "Contact informations" %}</u></h4>
  <dl class="dl-horizontal">
    <dt>{% trans "Address" %}</dt>
    <dd>
      {{ object.address }}<br />
      {{ object.zipcode }} {{ object.city }}<br />
      {{ object.country }}
    </dd>
    <dt>Email</dt><dd><a href="mailto:{{ object.email }}">{{ object.email }} </a></dd>
    {% if object.private_phone %}
    <dt>{% trans "Home phone" %}</dt>
    <dd>
      <a href="{{ object.private_phone|swissphone:'RFC3966' }}">{{ object.private_phone|swissphone }}</a>
    </dd>
    {% endif %}
    {% if object.private_phone2 %}
    <dt>{% trans "Mobile phone" %}</dt>
    <dd>
      <a href="{{ object.private_phone2|swissphone:'RFC3966' }}">{{ object.private_phone2|swissphone }}</a>
    </dd>
    {% endif %}
    {% if object.private_phone3 %}
    <dt>{% trans "Other phone" %}</dt>
    <dd>
      <a href="{{ object.private_phone3|swissphone:'RFC3966' }}">{{ object.private_phone3|swissphone }}</a>
    </dd>
    {% endif %}
  </dl>
  <p class="text-center">
    <a href="{{ object.get_update_url }}" class="btn btn-default btn-sm"><i class="icon-edit"></i>&nbsp;&nbsp;{% trans "Update contact informations" %}</a>
  </p>
</section>
<section class="portlet">
  <h4 class="portlet-title"><u>{% trans "Registration" %}</u></h4>
  <dl class="dl-horizontal">
    <dt>{% trans "Finished registration" %}?</dt>
    <dd>
    {% if object.finished_registration %}
      <i class="icon-ok-circled2 text-success"></i>
    {% else %}
      <i class="icon-cancel-circled2 text-danger"></i>
    {% endif %}
    </dd>
    
     <dt>{% trans "Paid" %}?</dt>
      <dd>
    {% if object.paid %}
      <i class="icon-ok-circled2 text-success"></i>
    {% else %}
      <i class="icon-cancel-circled2 text-danger"></i>
    {% endif %}
    </dd>
     
    <dt>{% trans "Total to be paid" %}</dt>
    <dd>{{ object.total|swissfranc }}</dd>
    <dt>{% trans "Transaction identifier" %}</dt>
    <dd>{{ object.billing_identifier }}</dd>
  </dl>
  <p class="text-center">
    <a href="{{ object.get_update_url }}" class="btn btn-default btn-sm"><i class="icon-edit"></i>&nbsp;&nbsp;{% trans "Update payement informations" %}</a>
  </p>
</section>

<section class="portlet">
  <h4 class="portlet-title"><u>{% trans "Children" %}</u></h4>
  <div class="row">
  {% for child in object.children.all %}
    <div class="col-sm-6 col-lg-4">
      <div class="pricing-plan">
        <header class="pricing-header">
          <h4 class="pricing-plan-title">{{  child }}</h4>
        </header>
        <dl class="dl-horizontal">
          <dt>{% trans "Sex" %}</dt><dd> {{ child.sex }}</dd>
          <dt>{% trans "Birth date" %}</dt><dd> {{ child.birth_date | date:"j F Y" }}</dd>
          <dt>{% trans "School year" %}</dt><dd> {{ child.school_year }}</dd>
          <dt>{% trans "Teacher" %}</dt><dd> {{ child.teacher.get_full_name }}</dd>
        </dl>
        <p class="text-center">
           <a href="" class="btn btn-default btn-sm"><i class="icon-edit"></i>&nbsp;&nbsp;{% trans "Update child" %}</a>
        </p>
        <h5 >{% trans "Registrations" %}</h5>
        <table class="table">
          <thead class="sr-only">
            <tr>
              <th>{% trans "Course" %}</th>
              <th>{% trans "Actions" %}</th>
            </tr>
          </thead>
          {% for registration in child.registration_set.all %}
          <tr>
            <td>
             <a href="{{ registration.course.get_backend_url }}">{{ registration.course.short_name }}</a>
            </td>
            <td>
              <ul class="list-unstyled">
                <li class="text-nowrap"><a href="{{ registration.get_update_url }}" class="btn btn-sm"><i class="icon-edit"></i>&nbsp;{% trans "Update registration" %}</a></li>
                <li class="text-nowrap"><a href="{{ registration.get_delete_url }}" class="btn btn-sm"><i class="icon-cancel"></i>&nbsp;{% trans "Cancel registration" %}</a></li>
              </ul>
              
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="2">{% trans "No registration for this child" %}</td></tr>
          {% endfor %}
        </table>
      </div>
    </div>
  {% endfor %}
  </div>
  <a href="" class="btn btn-success"><i class="icon-plus"></i>&nbsp;&nbsp;{% trans "Add child" %}</a>
</section>
{% endblock content %}