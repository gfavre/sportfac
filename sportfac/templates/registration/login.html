{% extends "base.html" %}
{% load i18n floppyforms humanize l10n countdowntimer %}

{% block title %}{% trans "Login" %}{% endblock %}
{% block page_title %}{% trans "Login" %}{% endblock page_title %}


{% block content %}
  <div class="row">
    <div class="col-sm-6 "  style="border-right: 1px solid #ccc">
      {% if registration_opened %}
        <p class="lead text-center">{% trans "You don't have an account?" %}<br>
          <a href="{% url 'wizard_register' %}" class="btn btn-large btn-primary" style="margin-top: 30px;">
            {% trans "Registration" %}
          </a>
        </p>
      {% elif REGISTER_ACCOUNTS_AT_ANY_TIME %}
        <p class="lead text-center">{% trans "You don't have an account?" %}<br>
          <a href="{% url 'anytime_registeraccount' %}" class="btn btn-large btn-primary" style="margin-top: 30px;">
            {% trans "Registration" %}
          </a>
        </p>
      {% else %}
        <h4>{% trans "Registrations are currently closed" %}</h4>
        {% if request.PHASE == 1 %}
          <p>
            {% blocktrans with registration_start=registration_start|date:"j F Y" registration_end=registration_end|date:"j F Y" %}
              They will open from {{ registration_start }} until {{ registration_end }}.{% endblocktrans %}</p>
          {% countdown registration_start %}

        {% endif %}
      {% endif %}
    </div>

    <div class="col-sm-6">
      <hr class="hidden-sm hidden-md hidden-lg">

      {% if registration_opened or REGISTER_ACCOUNTS_AT_ANY_TIME %}
        <p class="lead text-center">{% trans "You already have an account" %}</p>
      {% endif %}
      <form action="{{ app_path }}" method="post" id="login-form" class="form-horizontal">{% csrf_token %}
        {% for error in form.non_field_errors %}
          <div class="alert alert-danger" role="alert">
            <a class="close" href="#" data-dismiss="alert">Ã—</a>
            <i class="icon-cancel"></i>&nbsp;&nbsp;{{ error }}
          </div>
        {% endfor %}
        <input type="hidden" name="next" value="{{ next }}"/>

        {% form form using %}
          {% formconfig row using "floppyforms/rows/bootstrap.html" %}
          {% formrow form.username %}

          <div class="form-group {% if form.password.errors %}has-error{% endif %}">
            <label class="col-sm-2 control-label" for="id_password">{% trans 'Password' %}</label>
            <div class="col-sm-10">
              {% formfield form.password %}
              <p class="help-block"><span class="help-inline">{{ form.password.errors }}</span></p>
              <p class="help-block"><a
                  href="{% url 'registration_reset' %}">{% trans 'Forgotten your password or username?' %}</a></p>
            </div>
          </div>

        {% endform %}
        <div class="form-group">
          <div class="col-sm-offset-2 col-sm-10">
            <button type="submit" class="btn btn-primary">{% trans 'Log in' %}</button>
          </div>
        </div>
      </form>
    </div>
  </div>

{% endblock content %}

{% block extra_js %}
  <script>
    $('#id_username').focus();
  </script>
{% endblock %}
